<!doctype html>
<html>
<head>
    <title>Beer League Baseball Challenge</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta charset="UTF-8">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/bootstrap-responsive.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" type="text/css" href="css/bootstrap-form.css">
    <!-- Javascript -->
    <script src="js/jquery-1.9.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.validate.js"></script>
    <script>
     $(document).ready(function() {
        //form validation
        var validate = $("#modal_form").validate({
          rules: {
            teamName: {
              minlength: 2,
              required: true
            },
            firstName: {
              minlength: 2,
              required: true
            },
            lastName: {
              minlength: 2,
              required: true
            },
            phoneNumber: {
              digits: true,
              required: true,
              rangelength: [10, 10]
            },
            sponsor: {
              minlength: 2,
              required: true
            },
            zip: {       
              digits: true,
              required: true,
              rangelength: [5, 5]
            }
          },
          highlight: function(element) {
            $(element).closest('.control-group').removeClass('success').addClass('error');
          },
          success: function(element) {
            element
            .text('Valid').addClass('valid')
            .closest('.control-group').removeClass('error').addClass('success');
          }
        });
      
      // Declare Variables
      var league_array = [];
      var team_counter = 1;


      // Function to collect team information and store it in an array
      $('#modalSubmit').click(function() {
        if ($('#teamName').val() != "" && $('#firstName').val() != "" && $('#lastName').val() != "" && $('#phoneNumber').val() != "" && $('#sponsor').val() != "" && $('#zip').val() != "") {
          var team_array = [];
          
          $('.teamInput').each(function() {
            team_array.push($(this).val()); 
          }); //end teamInput each
          
          league_array.push(team_array);
          console.log(league_array);

          addTeam(team_array);
          
          //hides modal
          $('#myModal').modal('hide');
          //clears form
        }; //end if
          clearForm();
          //reset form validation
          $('.control-group').removeClass('success error');
          //.validate.resetForm();
      }); //end modal form submit button click
      
      // function to add all teams to the schedule
      function addTeam(team_array) {
        $('#teamTable').append("<tr><td>" + team_array[0] + "</td><td>" + 0 + "</td><td>" + 0 + "</td><td>" + 0 + "</td></tr>");
      };

      //function to clear the team input form
      function clearForm() {
        $('.teamInput').each(function() {
          $(this).val("");
        });
      };

      //function to test stuff and things
      $('#test').click(function(){
       var JSON_array = JSON.stringify(league_array);
       console.log(JSON_array);
          $.ajax({
           type: "POST",
           url: "http://www.nashvillecoder.me/awright/shared/",
           data: {
             "file": "http://www.nashvillecoder.me/awright/shared/beerLeague.json",
             "path": "/awright/shared",
             "data": {
               "name": "League Name",
               "owner": "Gary Naranjo",
               "teams": ["Sluggers","Sharks","Cyclones","Thunderheads","Quakers"]
             }
           },
           success: function (data) {
             console.log(data);
           },
           dataType: "json"
          }); //end ajax post
          $.ajax({
            url: 'http://www.nashvillecoder.me/shared/market.json',
            success: function (data) {
              console.log(data);
            }

          });//end ajax get
      });//end test click

     }); //end document ready
    </script>
</head>
<body>
<div class="container-fluid">
 <div class="span12 wrapper">
  <h1>Beer League Baseball Challenge</h1>

  <div class="tableWrap">
   <table class="table table-striped table-bordered">
    <caption>Standings</caption>
    <thead>
     <tr>
      <th>Team</th>
      <th>W</th>
      <th>L</th>
      <th>%</th>
     </tr>
    </thead>
    <tbody id="teamTable">
    </tbody>
   </table>     
  </div>

  <!-- Button to trigger modal -->
  <a href="#myModal" role="button" class="btn" data-toggle="modal">Add a Team</a>
  <button id="test" type="submit" class="btn" onclick="return false">test</button>
  <!-- Modal -->
  <div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
   <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
    <h3 id="myModalLabel">Team Information</h3>
   </div>
   <div class="modal-body">
    <form id="modal_form" class="form form-horizontal">
     <div class="control-group">
       <label class="control-label" for="teamName">Team Name</label>
       <div class="controls">
         <input name="teamName" type="text" id="teamName" class="teamInput" placeholder="Team Name">
       </div>
     </div>
     <div class="control-group">
       <label class="control-label" for="firstName">Manager First Name</label>
       <div class="controls">
         <input name="firstName" type="text" id="firstName" class="teamInput" placeholder="Manager First Name">
       </div>
     </div>
     <div class="control-group">
       <label class="control-label" for="lastName">Manager Last Name</label>
       <div class="controls">
         <input name="lastName" type="text" id="lastName" class="teamInput" placeholder="Manager Last Name">
       </div>
     </div>
     <div class="control-group">
       <label class="control-label" for="inputPhoneNumber">Phone Number</label>
       <div class="controls">
         <input name="phoneNumber" type="text" id="phoneNumber" class="teamInput" placeholder="Phone Number">
       </div>
     </div>
     <div class="control-group">
       <label class="control-label" for="sponsor">Sponsor</label>
       <div class="controls">
         <input name="sponsor" type="text" id="sponsor" class="teamInput" placeholder="Sponsor">
       </div>
     </div>
     <div class="control-group">
       <label class="control-label" for="zip">Zip Code</label>
       <div class="controls">
         <input name="zip" type="text" id="zip" class="teamInput" placeholder="Zip Code">
       </div>
     </div>
     <div class="controls">
       <button id="modalSubmit" type="submit" class="btn btn-primary" onclick="return false">Submit</button>
       <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
     </div>
    </form> 
   </div>
<!--    <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <button class="btn btn-primary">Save changes</button>
   </div> -->
  </div> <!-- End Modal -->
 </div> <!-- End Wrapper -->
</div> <!-- End Container -->
<div id="value"></div>
</body>
</html>